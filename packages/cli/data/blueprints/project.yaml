# Project management blueprint
# Provides: Task, Milestone types

- author: system
  configurations:
    # Fields
    - key: status
      type: Field
      name: Status
      dataType: option
      options: [pending, active, complete, cancelled, archived]
      default: pending

    - key: priority
      type: Field
      dataType: option
      options: [low, medium, high]
      default: medium

    - key: dueDate
      type: Field
      name: Due Date
      dataType: date

    - key: parent
      type: Field
      name: Parent
      dataType: relation
      inverseOf: children

    - key: children
      type: Field
      name: Children
      dataType: relation
      allowMultiple: true
      inverseOf: parent

    - key: milestone
      type: Field
      name: Milestone
      dataType: relation
      range: [Milestone]
      inverseOf: milestoneTasks

    - key: milestoneTasks
      type: Field
      name: Milestone Tasks
      dataType: relation
      range: [Task]
      allowMultiple: true
      inverseOf: milestone

    # Types
    - key: Task
      type: Type
      name: Task
      fields:
        - title: { required: true }
        - description
        - status
        - priority
        - dueDate
        - parent: { only: [Task] }
        - children: { only: [Task] }
        - milestone

    - key: Milestone
      type: Type
      name: Milestone
      fields:
        - title: { required: true }
        - description
        - status
        - dueDate
        - milestoneTasks

# Navigation Structure
- author: system
  configurations:
    # Milestones (one file per milestone with its tasks)
    - key: nav-milestone
      type: Navigation
      path: milestones/{key}
      where: { type: Milestone, status: [pending, active] }
      includes:
        key: true
        title: true
        description: true
        status: true
        dueDate: true
        milestoneTasks:
          title: true
          status: true
          priority: true
          dueDate: true

    # Backlog (tasks without milestones)
    - key: nav-backlog
      type: Navigation
      path: backlog
      query:
        filters:
          type: Task
          milestone: { op: empty, value: true }
          status: [pending, active]

    # Archive
    - key: nav-archive-milestone
      type: Navigation
      path: archive/milestones/{key}
      where: { type: Milestone, status: complete }
      includes:
        key: true
        title: true
        description: true
        status: true
        dueDate: true
        milestoneTasks:
          title: true
          status: true
          priority: true
          dueDate: true

    - key: nav-archive-backlog
      type: Navigation
      path: archive/tasks
      query:
        filters:
          {
            type: Task,
            milestone: { op: empty, value: true },
            status: complete,
          }

# Sample data
- author: system
  nodes:
    # Milestones (concurrent goals, not sequential phases)
    - type: Milestone
      key: mvp-release
      title: MVP Release
      description: Ship core functionality to beta testers
      status: active
      dueDate: 2025-02-15

    - type: Milestone
      key: user-feedback
      title: User Testing Round
      description: Gather feedback from 20 beta users
      status: active
      dueDate: 2025-02-28

    - type: Milestone
      key: v1-launch
      title: V1 Public Launch
      description: App store release
      dueDate: 2025-04-01

    # Tasks - mixed work streams
    - type: Task
      title: Build authentication flow
      description: Login, signup, password reset
      status: complete
      priority: high
      milestone: mvp-release

    - type: Task
      title: Design onboarding screens
      status: active
      priority: medium
      milestone: mvp-release

    - type: Task
      title: Set up crash reporting
      status: active
      priority: high
      milestone: mvp-release

    - type: Task
      title: Write user interview script
      status: complete
      priority: medium
      milestone: user-feedback

    - type: Task
      title: Recruit beta testers
      status: active
      priority: high
      milestone: user-feedback

    - type: Task
      title: App store listing copy
      priority: low
      milestone: v1-launch

    - type: Task
      title: Investigate push notifications
      description: Research options for cross-platform push
      priority: low

    - type: Task
      title: Fix landscape orientation bug
      status: active
      priority: medium
